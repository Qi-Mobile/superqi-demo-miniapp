<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Sample Miniapp - Get Storage</title>
    <script src="/common/main.js"></script>
    <script src="https://cdn.marmot-cloud.com/npm/hylid-bridge/2.10.0/index.js"></script>
    <link rel="stylesheet" href="/common/style.css">
    <style>
        .storage-container {
            background: #f5f5f5;
            padding: 16px;
            border-radius: 8px;
            margin: 16px 0;
        }
        
        
        
        .demo-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 16px 0;
        }
        
        .demo-buttons button {
            flex: 1;
            min-width: 140px;
        }
        
        .bg-orange-400 {
            background-color: #fb923c;
        }
    </style>
</head>

<body>
    <div class="flex flex-col w-full h-full min-h-full">
        <miniapp-header></miniapp-header>

        <div class="flex flex-col gap-2 mb-4 px-4">
            <h2 class="text-xl font-bold mb-4">Storage Demo - Set and Get Cached Data</h2>
            <p class="text-sm text-gray-600 mb-4">You need to set the data first, then you can get the data.</p>
            
            <!-- my.setStorage -->
            <div class="storage-container">
                <h3 class="text-lg font-bold mb-4">Set Demo Data</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Set demo data using my.setStorage API
                </p>
                
                <div class="demo-buttons">
                    <button onclick="setDemoCity()" class="bg-green-400 text-white px-4 py-2 font-bold rounded-md">
                        Set City Data
                    </button>
                    <button onclick="setDemoUser()" class="bg-green-400 text-white px-4 py-2 font-bold rounded-md">
                        Set User Data
                    </button>
                    <button onclick="setDemoSettings()" class="bg-green-400 text-white px-4 py-2 font-bold rounded-md">
                        Set Settings
                    </button>
                </div>
            </div>

            <!-- my.getStorage -->
            <div class="storage-container">
                <h3 class="text-lg font-bold mb-4">Get Demo Data</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Retrieve demo data using my.getStorage API
                </p>
                
                <div class="demo-buttons">
                    <button onclick="getDemoCity()" class="bg-blue-400 text-white px-4 py-2 font-bold rounded-md">
                        Get City Data
                    </button>
                    <button onclick="getDemoUser()" class="bg-blue-400 text-white px-4 py-2 font-bold rounded-md">
                        Get User Data
                    </button>
                    <button onclick="getDemoSettings()" class="bg-blue-400 text-white px-4 py-2 font-bold rounded-md">
                        Get Settings
                    </button>
                </div>
            </div>


            <!-- my.removeStorage -->
            <div class="storage-container">
                <h3 class="text-lg font-bold mb-4">Remove Storage</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Remove specific storage data using my.removeStorage API
                </p>
                
                <div class="demo-buttons">
                    <button onclick="removeDemoCity()" class="bg-orange-400 text-white px-4 py-2 font-bold rounded-md">
                        Remove City Data
                    </button>
                    <button onclick="removeDemoUser()" class="bg-orange-400 text-white px-4 py-2 font-bold rounded-md">
                        Remove User Data
                    </button>
                    <button onclick="removeDemoSettings()" class="bg-orange-400 text-white px-4 py-2 font-bold rounded-md">
                        Remove Settings
                    </button>
                </div>
            </div>

            <!-- my.clearStorage -->
            <div class="storage-container">
                <h3 class="text-lg font-bold mb-4">Clear All Storage</h3>
                <p class="text-sm text-gray-600 mb-4">
                    Remove all storage data using my.clearStorage API
                </p>
                <button onclick="clearAllStorage()" class="bg-red-400 text-white px-4 py-2 font-bold rounded-md">
                    Clear All Storage
                </button>
            </div>
        </div>

        <section id="content" class="flex-1 mt-4 flex flex-col items-start p-4">
            <miniapp-console class="w-full h-full"></miniapp-console>
        </section>
    </div>
</body>

<script>


    function setDemoCity() {
        const cityData = {
            cityName: 'San Francisco',
            country: 'USA',
            timezone: 'PST',
            coordinates: { lat: 37.7749, lng: -122.4194 }
        };
        
        console.log('Setting demo city data...');
        my.setStorage({
            key: 'currentCity',
            data: cityData,
            success: function() {
                console.log('City data set successfully:', cityData);
            },
            fail: function(res) {
                console.error('Failed to set city data:', res);
            }
        });
    }

    function setDemoUser() {
        const userData = {
            name: 'John Doe',
            email: 'john@example.com',
            preferences: {
                theme: 'dark',
                language: 'en',
                notifications: true
            }
        };
        
        console.log('Setting demo user data...');
        my.setStorage({
            key: 'userProfile',
            data: userData,
            success: function() {
                console.log('User data set successfully:', userData);
            },
            fail: function(res) {
                console.error('Failed to set user data:', res);
            }
        });
    }

    function setDemoSettings() {
        const settingsData = {
            appVersion: '1.0.0',
            lastLogin: new Date().toISOString(),
            features: ['videoPlayer', 'imagePicker', 'storageDemo'],
            cacheSize: '2.5MB'
        };
        
        console.log('Setting demo settings data...');
        my.setStorage({
            key: 'appSettings',
            data: settingsData,
            success: function() {
                console.log('Settings data set successfully:', settingsData);
            },
            fail: function(res) {
                console.error('Failed to set settings data:', res);
            }
        });
    }

    function getDemoCity() {
        console.log('Getting demo city data...');
        my.getStorage({
            key: 'currentCity',
            success: function(res) {
                console.log('City data retrieved successfully:', res);
            },
            fail: function(res) {
                console.error('Failed to get city data:', res);
            }
        });
    }

    function getDemoUser() {
        console.log('Getting demo user data...');
        my.getStorage({
            key: 'userProfile',
            success: function(res) {
                console.log('User data retrieved successfully:', res);
            },
            fail: function(res) {
                console.error('Failed to get user data:', res);
            }
        });
    }

    function getDemoSettings() {
        console.log('Getting demo settings data...');
        my.getStorage({
            key: 'appSettings',
            success: function(res) {
                console.log('Settings data retrieved successfully:', res);
            },
            fail: function(res) {
                console.error('Failed to get settings data:', res);
            }
        });
    }

    function removeDemoCity() {
        console.log('Removing demo city data...');
        my.removeStorage({
            key: 'currentCity',
            success: function() {
                console.log('City data removed successfully');
            },
            fail: function(res) {
                console.error('Failed to remove city data:', res);
            },
            complete: function() {
                console.log('Remove city data operation completed');
            }
        });
    }

    function removeDemoUser() {
        console.log('Removing demo user data...');
        my.removeStorage({
            key: 'userProfile',
            success: function() {
                console.log('User data removed successfully');
            },
            fail: function(res) {
                console.error('Failed to remove user data:', res);
            },
            complete: function() {
                console.log('Remove user data operation completed');
            }
        });
    }

    function removeDemoSettings() {
        console.log('Removing demo settings data...');
        my.removeStorage({
            key: 'appSettings',
            success: function() {
                console.log('Settings data removed successfully');
            },
            fail: function(res) {
                console.error('Failed to remove settings data:', res);
            },
            complete: function() {
                console.log('Remove settings data operation completed');
            }
        });
    }

    function clearAllStorage() {
        console.log('Clearing all storage...');
        my.clearStorage({
            success: function() {
                console.log('Storage cleared successfully');
            },
            fail: function(res) {
                console.error('Failed to clear storage:', res);
            }
        });
    }

    window.onload = () => {
        console.log('Storage demo page loaded');
    };
</script>

</html>